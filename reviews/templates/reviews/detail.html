{% extends 'base.html' %}
{% block content %}
  <h1>detail.html</h1>
  <a href="{% url 'reviews:update' review.pk%}" class='btn btn-success'>수정하기</a>
  <form action="{% url 'reviews:delete' review.pk %}" method='POST'>
    {% csrf_token %}
    <input type="submit" value='삭제' class='btn btn-danger'>
  </form>
  <div class="">
    {% if review.image %}
      <img src="{{ review.image.url }}" alt="{{review.image}}">
    {% endif %}
    <h3>
      {{ review.store_name }}
    </h3>

    <p>
      {{ review.store_address }}
    </p>
    <p>
      {{ review.phoneNumber }}
    </p>
    <p>
      {{ review.parking }}
    </p>
    <p>
      {{ review.price }}
    </p>
    <p>
      {{ review.time }}
    </p>
    <p>
      {{ review.breaktime }}
    </p>
    <p>
      {{ review.content }}
    </p>
    <div class="" id='map' style='width:500px; height:500px;'></div>
  </div>
  <a href="{% url 'reviews:comment_create' review.pk %}">이 집 평가하자</a>

  <h2>맛 평가 리스트</h2>
  {% for comment in comments %}
    <p>맛 평가:{{ comment.grade }}점</p>
    <p>작성일:{{ comment.created_at }}</p>
    <p>추천:{{ comment.tag }}</p>
    {% if comment.image %}
      <img src="{{ comment.image.url }}" alt="{{comment.image}}" width='180px;'>
    {% endif %}

  {% endfor %}

  <script>
    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
      mapOption = {
        center: new kakao
          .maps
          .LatLng(33.450701, 126.570667), // 지도의 중심좌표
        level: 3 // 지도의 확대 레벨
      };

    // 지도를 생성합니다
    var map = new kakao
      .maps
      .Map(mapContainer, mapOption);

    // 주소-좌표 변환 객체를 생성합니다
    var geocoder = new kakao
      .maps
      .services
      .Geocoder();

    // 주소로 좌표를 검색합니다
    geocoder.addressSearch('서울 마포구 동교로38길 27-4 1층', function (result, status) {

      // 정상적으로 검색이 완료됐으면
      if (status === kakao.maps.services.Status.OK) {

        var coords = new kakao
          .maps
          .LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new kakao
          .maps
          .Marker({map: map, position: coords});

        // 인포윈도우로 장소에 대한 설명을 표시합니다
        var infowindow = new kakao
          .maps
          .InfoWindow({content: '<div style="width:150px;text-align:center;padding:6px 0;">하나라멘</div>'});
        infowindow.open(map, marker);

        // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
        map.setCenter(coords);
      }
    });
  </script>

{% endblock content %}